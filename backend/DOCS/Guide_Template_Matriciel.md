# ğŸ“Š Template Excel Import Volumes - STRUCTURE MATRICIELLE

## ğŸ¯ Fichier GÃ©nÃ©rÃ©
`Template_Import_Volumes_Matriciel_20260107.xlsx`

---

## ğŸ“ Structure EXACTE du Template

Le template reproduit **EXACTEMENT** la structure de l'interface utilisateur avec une disposition matricielle.

---

### ğŸ”µ SECTION A : FLUX ARRIVÃ‰E

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FLUX \ SEGMENT  â”‚ GLOBAL  â”‚  PART.  â”‚   PRO   â”‚  DIST.  â”‚  AXES   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Amana           â”‚         â”‚         â”‚         â”‚         â”‚         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CO              â”‚         â”‚         â”‚         â”‚         â”‚         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CR              â”‚         â”‚         â”‚         â”‚         â”‚         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ E-Barkia        â”‚         â”‚         â”‚         â”‚         â”‚         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ LRH             â”‚         â”‚         â”‚         â”‚         â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Dimensions** : 5 lignes (flux) Ã— 5 colonnes (segments)

**Flux (lignes)** :
1. Amana
2. CO (Courrier Ordinaire)
3. CR (Courrier RecommandÃ©)
4. E-Barkia
5. LRH

**Segments (colonnes)** :
1. GLOBAL - Volume global non segmentÃ©
2. PART. - Segment Particuliers
3. PRO - Segment Professionnels
4. DIST. - Segment Distribution
5. AXES - Segment Axes stratÃ©giques

---

### ğŸŸ¢ SECTION B : GUICHET

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   OPÃ‰RATION     â”‚  DÃ‰PÃ”T  â”‚  RÃ‰CUP. â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Volume          â”‚         â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Dimensions** : 1 ligne Ã— 2 colonnes

**OpÃ©rations** :
1. DÃ‰PÃ”T - Volume des opÃ©rations de dÃ©pÃ´t au guichet
2. RÃ‰CUP. - Volume des opÃ©rations de rÃ©cupÃ©ration au guichet

---

### ğŸ”´ SECTION C : FLUX DÃ‰PART

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FLUX \ SEGMENT  â”‚ GLOBAL  â”‚  PART.  â”‚   PRO   â”‚  DIST.  â”‚  AXES   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Amana           â”‚         â”‚         â”‚         â”‚         â”‚         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CO              â”‚         â”‚         â”‚         â”‚         â”‚         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CR              â”‚         â”‚         â”‚         â”‚         â”‚         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ E-Barkia        â”‚         â”‚         â”‚         â”‚         â”‚         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ LRH             â”‚         â”‚         â”‚         â”‚         â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Dimensions** : 5 lignes (flux) Ã— 5 colonnes (segments)

**Structure identique Ã  FLUX ARRIVÃ‰E**

---

## ğŸ“‹ Exemple de Remplissage

### Exemple Complet :

```
Centre ID: 1
Nom du Centre: Centre Casablanca
Poste ID: (vide pour niveau centre)

A) FLUX ARRIVÃ‰E
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FLUX \ SEGMENT  â”‚ GLOBAL  â”‚  PART.  â”‚   PRO   â”‚  DIST.  â”‚  AXES   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Amana           â”‚   100   â”‚    50   â”‚    30   â”‚    15   â”‚     5   â”‚
â”‚ CO              â”‚   200   â”‚   100   â”‚    60   â”‚    30   â”‚    10   â”‚
â”‚ CR              â”‚    50   â”‚    25   â”‚    15   â”‚     8   â”‚     2   â”‚
â”‚ E-Barkia        â”‚    30   â”‚    15   â”‚    10   â”‚     4   â”‚     1   â”‚
â”‚ LRH             â”‚    20   â”‚    10   â”‚     6   â”‚     3   â”‚     1   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

B) GUICHET
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   OPÃ‰RATION     â”‚  DÃ‰PÃ”T  â”‚  RÃ‰CUP. â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Volume          â”‚   150   â”‚    80   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

C) FLUX DÃ‰PART
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FLUX \ SEGMENT  â”‚ GLOBAL  â”‚  PART.  â”‚   PRO   â”‚  DIST.  â”‚  AXES   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Amana           â”‚    90   â”‚    45   â”‚    27   â”‚    13   â”‚     5   â”‚
â”‚ CO              â”‚   180   â”‚    90   â”‚    54   â”‚    27   â”‚     9   â”‚
â”‚ CR              â”‚    45   â”‚    22   â”‚    13   â”‚     7   â”‚     3   â”‚
â”‚ E-Barkia        â”‚    25   â”‚    12   â”‚     8   â”‚     4   â”‚     1   â”‚
â”‚ LRH             â”‚    15   â”‚     8   â”‚     5   â”‚     2   â”‚     0   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ CaractÃ©ristiques Visuelles

### Couleurs
- **En-tÃªtes** : Bleu Barid (#005EA8) avec texte blanc
- **Sections** : Bleu clair (#E8F4F8)
- **Flux** : Gris clair (#F0F0F0)
- **Cellules de saisie** : Blanc avec bordures

### Formatage
- **Bordures Ã©paisses** : Autour des en-tÃªtes
- **Bordures fines** : Entre les cellules
- **Alignement** : CentrÃ© pour les valeurs, gauche pour les flux
- **Format numÃ©rique** : `#,##0` (sÃ©parateur de milliers)

---

## ğŸ“ Instructions de Remplissage

### Ã‰tape 1 : Identification
1. Remplir **Centre ID** (obligatoire)
2. Remplir **Nom du Centre** (obligatoire)
3. Remplir **Poste ID** (optionnel, uniquement pour import au niveau poste)

### Ã‰tape 2 : Flux ArrivÃ©e
- Remplir la matrice 5Ã—5
- Chaque cellule = intersection d'un flux et d'un segment
- Exemple : Cellule (Amana, GLOBAL) = volume Amana global en arrivÃ©e

### Ã‰tape 3 : Guichet
- Remplir les 2 cellules : DÃ‰PÃ”T et RÃ‰CUP.

### Ã‰tape 4 : Flux DÃ©part
- Remplir la matrice 5Ã—5 (mÃªme structure que Flux ArrivÃ©e)
- Chaque cellule = intersection d'un flux et d'un segment

### Ã‰tape 5 : Validation
- VÃ©rifier que tous les nombres sont valides
- Laisser vide si volume = 0
- Ne pas modifier la structure

---

## ğŸ”„ Correspondance avec l'Interface UI

### Vue Intervenant / Vue Centre

L'interface affiche exactement la mÃªme structure :

**Dans l'UI** :
```
â”Œâ”€ FLUX ARRIVÃ‰E â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                      â”‚
â”‚  [Matrice 5 flux Ã— 5 segments]                      â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ GUICHET â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DÃ‰PÃ”T  â”‚  RÃ‰CUP.       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ FLUX DÃ‰PART â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                      â”‚
â”‚  [Matrice 5 flux Ã— 5 segments]                      â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Dans Excel** : Structure identique, cellule par cellule

---

## âœ… Avantages de cette Structure

1. **Visuel identique** : Reproduction exacte de l'UI
2. **FacilitÃ© de saisie** : Structure intuitive
3. **Pas d'erreur** : Correspondance 1:1 avec l'interface
4. **Validation visuelle** : On voit immÃ©diatement la structure
5. **Import direct** : Mapping automatique vers la base de donnÃ©es

---

## ğŸ”§ GÃ©nÃ©ration du Template

Pour rÃ©gÃ©nÃ©rer le template :

```bash
cd backend
python scripts/generate_matrix_template.py
```

Le fichier sera crÃ©Ã© : `Template_Import_Volumes_Matriciel_YYYYMMDD.xlsx`

---

## ğŸ“Š Mapping Base de DonnÃ©es

Chaque cellule du template correspond Ã  :

```python
{
    "centre_id": [Centre ID],
    "centre_poste_id": [Poste ID ou NULL],
    "flux_id": [1=Amana, 2=CO, 3=CR, 4=E-Barkia, 5=LRH],
    "sens_id": [1=ArrivÃ©e, 2=Guichet, 3=DÃ©part],
    "segment_id": [1=GLOBAL, 2=PART, 3=PRO, 4=DIST, 5=AXES, 6=DEPOT, 7=RECUP],
    "volume": [Valeur de la cellule]
}
```

**Exemple** :
- Cellule (Amana, GLOBAL) dans Flux ArrivÃ©e
  â†’ `flux_id=1, sens_id=1, segment_id=1, volume=[valeur]`

- Cellule DÃ‰PÃ”T dans Guichet
  â†’ `flux_id=NULL, sens_id=2, segment_id=6, volume=[valeur]`

---

## ğŸ¯ RÃ©sumÃ©

âœ… **Structure matricielle** : Flux en lignes, Segments en colonnes
âœ… **3 sections** : Flux ArrivÃ©e, Guichet, Flux DÃ©part
âœ… **Reproduction exacte** : Identique Ã  l'interface UI
âœ… **FacilitÃ© d'utilisation** : Saisie intuitive
âœ… **Import direct** : Compatible avec l'API

**Le template est prÃªt Ã  l'emploi !** ğŸš€

---

**Â© 2026 TAWAZOON RH - Barid Al-Maghrib**
